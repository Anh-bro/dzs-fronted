import{_ as P,D as R,a0 as U,X as r,a1 as E,a2 as A,B as v,a3 as F,a4 as H,W as O,o as u,j as b,w as o,I as j,a as l,H as L,d as c,b as _,t as J,c as M,k as W,e as X,h as Y,M as Z,N as q,O as z,P as G,Y as K,Z as Q,a5 as $,a6 as ee,f as te,a7 as le,E as oe,J as ae}from"./index-a735f570.js";/* empty css                    *//* empty css                     *//* empty css                        *//* empty css                */const ne={data(){return{dataonLineListSelections:{},aid:0,form:{level:"",content:""},passageData:[],loading:!1,data:[],dataNum:0,dialogFormVisible:!1,nodename:""}},mounted(){this.fetchData()},methods:{async fetchData(){await R().then(e=>{console.log(e),this.data=e.data}),await U().then(e=>{console.log(e),this.dataNum=e.data})},async appendRootNode(){if(this.nodename==""){r({title:"错误",message:"节点名称为空！",type:"error"});return}const e={id:++this.dataNum,pid:this.dataNum,label:this.nodename,children:[]};this.data.push(e),this.loading=!0,await E({id:e.id,pid:e.pid,label:e.label}).then(t=>{console.log(t)}),this.loading=!1},async append(e){if(this.nodename==""){r({title:"错误",message:"节点名称为空！",type:"error"});return}const t=this.$refs.myTree.getNode({id:e.pid}),s=this.$refs.myTree.getNode({id:t.data.pid});if(console.log(e.pid),console.log(t.data.pid),console.log(s.data.pid),t.data.pid==e.pid&&s.data.pid==t.data.pid){console.log(t);const d={id:++this.dataNum,pid:e.id,label:this.nodename,children:[]};e.children||this.$set(e,"children",[]),e.children.push(d),this.loading=!0,await E({id:d.id,pid:d.pid,label:d.label}).then(a=>{console.log(a)}),this.loading=!1,console.log(e)}else{r({title:"错误",message:"层级太多！",type:"error"});return}},async remove(e,t){const s=e.parent,d=s.data.children||s.data,a=d.findIndex(i=>i.id===t.id);d.splice(a,1),this.loading=!0,await A(t.id).then(i=>{console.log(i)}),this.loading=!1},edit(e,t){v(t.id).then(s=>{console.log(s),this.passageData=s.data}),this.aid=t.id},async addPassageContent(){if(this.form.level==""){r({title:"错误",message:"请选择类型！",type:"error"});return}if(this.aid==0){r({title:"错误",message:"请先选择章节进行编辑！",type:"error"});return}if(this.form.level!="img"){if(console.log(this.form.level),this.form.content==""){r({title:"错误",message:"文字内容不能为空！",type:"error"});return}F({aid:this.aid,level:this.form.level,content:this.form.content}).then(e=>{console.log(e)})}else this.$refs.myupload.submit();await v(this.aid).then(e=>{console.log(e),this.passageData=e.data,r({title:"成功",message:"添加成功！",type:"sucess"}),this.$forceUpdate()}),console.log(this.passageData)},async deleteTableRow(){console.log(this.dataonLineListSelections.aid),await H({aid:this.dataonLineListSelections.aid,orderid:this.dataonLineListSelections.orderid}).then(e=>{O({aid:this.dataonLineListSelections.aid,orderid:this.dataonLineListSelections.orderid}).then(t=>{console.log(t)}),console.log(e),e.code==200&&(v(this.aid).then(t=>{console.log(t),this.passageData=t.data}),this.$forceUpdate(),r({title:"成功",message:"删除成功！",type:"sucess"}))})},selectionLineChangeHandle(e){this.dataonLineListSelections=e}}},ie={style:{"justify-content":"space-between"}},se={class:"custom-tree-node"},de=["onClick"],re=["onClick"],ce=["onClick"],pe=["src"],me={style:{height:"200px"}};function he(e,t,s,d,a,i){const w=X,p=Y,V=Z,x=q,C=z,f=G,g=K,T=Q,m=$,D=ee,h=te,S=le,I=oe,B=j,k=ae;return u(),b(B,null,{default:o(()=>[l(f,{span:8},{default:o(()=>[L((u(),b(C,{shadow:"hover",onClick:e.clickTreeNode},{default:o(()=>[c("div",ie,[l(w,{style:{display:"inline"},placeholder:"输入节点名称",modelValue:a.nodename,"onUpdate:modelValue":t[0]||(t[0]=n=>a.nodename=n)},null,8,["modelValue"]),l(p,{onClick:t[1]||(t[1]=n=>i.appendRootNode())},{default:o(()=>[_("增加")]),_:1})]),l(x,{"max-height":"600px"},{default:o(()=>[l(V,{data:a.data,"expand-on-click-node":!1,"node-key":"id","default-expand-all":"",ref:"myTree"},{default:o(({node:n,data:y})=>[c("span",se,[c("span",null,J(n.label),1),c("span",null,[c("a",{onClick:N=>i.append(y)}," 增加 ",8,de),c("a",{style:{"margin-left":"8px"},onClick:N=>i.remove(n,y)}," 删除 ",8,re),c("a",{style:{"margin-left":"8px"},onClick:N=>i.edit(n,y)}," 编辑 ",8,ce)])])]),_:1},8,["data"])]),_:1})]),_:1},8,["onClick"])),[[k,a.loading]])]),_:1}),l(f,{span:16,"margin-left":"5px"},{default:o(()=>[l(x,{"max-height":"400px",style:{"scroll-bahavior":"smooth"}},{default:o(()=>[l(T,{"highlight-current-row":"",ref:"myTable",data:a.passageData,style:{width:"100%"},border:"true",onRowClick:i.selectionLineChangeHandle},{default:o(()=>[l(g,{prop:"aid",label:"Aid",width:"50px"}),l(g,{prop:"content",label:"Content","show-overflow-tooltip":"true"},{default:o(n=>[n.row.level=="img"?(u(),M("img",{key:0,src:n.row.content,style:{height:"100px"},alt:""},null,8,pe)):W("",!0)]),_:1}),l(g,{prop:"level",label:"Level",width:"100px"})]),_:1},8,["data","onRowClick"])]),_:1})]),_:1}),l(f,{span:24},{default:o(()=>[L((u(),b(C,{shadow:"hover",height:"200"},{default:o(()=>[c("div",me,[l(I,{model:a.form,inline:!1},{default:o(()=>[l(h,{label:"添加类型:"},{default:o(()=>[l(D,{modelValue:a.form.level,"onUpdate:modelValue":t[2]||(t[2]=n=>a.form.level=n),placeholder:"请选择类型"},{default:o(()=>[l(m,{label:"一级标题",value:"title1"}),l(m,{label:"二级标题",value:"title2"}),l(m,{label:"正文",value:"paragraph"}),l(m,{label:"图片",value:"img"})]),_:1},8,["modelValue"])]),_:1}),l(h,{label:"文字内容:"},{default:o(()=>[l(w,{modelValue:a.form.content,"onUpdate:modelValue":t[3]||(t[3]=n=>a.form.content=n),type:"textarea"},null,8,["modelValue"])]),_:1}),l(h,{label:"图片内容:"},{default:o(()=>[l(S,{ref:"myupload",class:"upload-demo",action:"/api/upload",limit:1,"on-exceed":e.handleExceed,"auto-upload":!1,name:"photo",data:{aid:this.aid}},{trigger:o(()=>[l(p,{type:"primary"},{default:o(()=>[_("select file")]),_:1})]),_:1},8,["on-exceed","data"]),l(p,{style:{"margin-left":"200px"},type:"primary",onClick:t[4]||(t[4]=n=>i.addPassageContent())},{default:o(()=>[_("添加")]),_:1}),l(p,{style:{"margin-left":"20px"},type:"primary",onClick:t[5]||(t[5]=n=>i.deleteTableRow())},{default:o(()=>[_("删除选中行")]),_:1})]),_:1}),l(h)]),_:1},8,["model"])])]),_:1})),[[k,a.loading]])]),_:1})]),_:1})}const ve=P(ne,[["render",he]]);export{ve as default};
